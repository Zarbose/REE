#!/bin/bash

LOG_FILE="/var/log/REE.log"

# Fonction pour ajouter un timestamp aux messages de logs
log() {
    echo "$(date '+%Y-%m-%d %H:%M:%S') - $1" >> "$LOG_FILE"
}

# Raspberry numÃ©ro 1.
log "Raspberry numero 1."

#clean /etc/iptables/rules.v4
echo " " > /etc/iptables/rules.v4

# Finalisation de la configuration IPtable
iptables -F
iptables -t nat -F
iptables -P INPUT ACCEPT
iptables -P FORWARD ACCEPT
iptables -P OUTPUT ACCEPT
iptables -A FORWARD -i wlan0 -o eth0 -j ACCEPT
iptables -A FORWARD -i eth0 -o wlan0 -j ACCEPT
iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
sh -c "iptables-save > /etc/iptables/rules.v4" 

log "Ecriture des iptables."


