#!/bin/bash

FICHIER_AUDIO="../sound/alarm.wav"
SEUIL_WIFI_SIGNAL=-85

while x=1; 
do  
    
    #linux (replace "cat output.txt" by iwconfig command )
    SIGNAL=$(iwconfig wlan0 | grep Quality | awk  '{print $4}' | cut -d'=' -f2)
    #echo $SIGNAL

    if [ $SIGNAL -lt $SEUIL_WIFI_SIGNAL ]
    then
        echo "Signal Wi-Fi trop faible. DÃ©clenchement de l'alarme..."
        #aplay -d 3 "$FICHIER_AUDIO" # "-d 3" -> duration of 3 sec
        espeak "Stop"
        sleep 0.3
        espeak "Stop"
        sleep 0.3
        espeak "Stop"

        exit 1
    fi
    sleep 0.5
done