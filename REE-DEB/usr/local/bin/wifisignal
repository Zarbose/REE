#!/bin/bash

SEUIL_WIFI_SIGNAL=-68

while true; 
do  
    
    declare -a tableau
    for ((i=0; i<10; i++)); do
        SIGNAL=$(iwconfig wlan1 | grep Signal | awk  '{print $4}' | cut -d'=' -f2)
        tableau+=($(echo $SIGNAL))
        sleep 0.1
    done
    somme=0
    for valeur in "${tableau[@]}"; do
        somme=$((somme + valeur))
    done
    moyenne=$((somme / ${#tableau[@]}))

    if [ $moyenne -lt $SEUIL_WIFI_SIGNAL ]
    then
        echo "Signal Wi-Fi trop faible. DÃ©clenchement de l'alarme..."
        espeak "Stop"
        sleep 0.3
        espeak "Stop"
        sleep 0.3
        espeak "Stop"

        exit 0
    fi
    unset tableau
done

